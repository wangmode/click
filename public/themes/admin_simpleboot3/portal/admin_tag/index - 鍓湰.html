<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>layuiAdmin 内容系统 - 文章列表</title>
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=0">
    <link rel="stylesheet" href="__TMPL__/public/static/admin/layuiadmin/layui/css/layui.css" media="all">
    <link rel="stylesheet" href="__TMPL__/public/static/admin/layuiadmin/style/admin.css" media="all">
    <script type="text/javascript" src="__TMPL__/public/js/jquery.min.js"></script>
</head>
<body layadmin-themealias="green-header">
<div class="layui-fluid">
    <div class="layui-card">
    <div class="layui-card-header">文章管理</div>
        <div class="layui-form layui-card-header layuiadmin-card-header-auto">
            <div class="layui-form-item">
                <div class="layui-inline">
                    <label class="layui-form-label">ID</label>
                    <div class="layui-input-inline">
                        <input type="text" name="id" placeholder="请输入" autocomplete="off" class="layui-input">
                    </div>
                </div>
                <div class="layui-inline">
                    <label class="layui-form-label">作者</label>
                    <div class="layui-input-inline">
                        <input type="text" name="author" placeholder="请输入" autocomplete="off" class="layui-input">
                    </div>
                </div>
                <div class="layui-inline">
                    <label class="layui-form-label">标题</label>
                    <div class="layui-input-inline">
                        <input type="text" name="title" placeholder="请输入" autocomplete="off" class="layui-input">
                    </div>
                </div>
                <div class="layui-inline">
                    <label class="layui-form-label">文章标签</label>
                    <div class="layui-input-inline">
                        <select name="label">
                            <option value="">请选择标签</option>
                            <option value="0">互联网</option>
                            <option value="1">新闻</option>
                            <option value="2">八卦</option>
                            <option value="3">体育</option>
                            <option value="4">音乐</option>
                        </select><div class="layui-unselect layui-form-select"><div class="layui-select-title"><input type="text" placeholder="请选择标签" value="" readonly="" class="layui-input layui-unselect"><i class="layui-edge"></i></div><dl class="layui-anim layui-anim-upbit"><dd lay-value="" class="layui-select-tips">请选择标签</dd><dd lay-value="0" class="">美食</dd><dd lay-value="1" class="">新闻</dd><dd lay-value="2" class="">八卦</dd><dd lay-value="3" class="">体育</dd><dd lay-value="4" class="">音乐</dd></dl></div>
                    </div>
                </div>
                <div class="layui-inline">
                    <button class="layui-btn layuiadmin-btn-list" lay-submit="" lay-filter="LAY-app-contlist-search">
                        <i class="layui-icon layui-icon-search layuiadmin-button-btn"></i>
                    </button>
                </div>
            </div>
        </div>

        <div class="layui-card-body">
            <div style="padding-bottom: 10px;">
                <button class="layui-btn layuiadmin-btn-list" data-type="batchdel">删除</button>
                <button class="layui-btn layuiadmin-btn-list" data-type="add">添加</button>
            </div>
            <table id="" lay-filter="LAY-app-content-list"></table>
            <div class="layui-form layui-border-box layui-table-view" lay-filter="LAY-table-1" style=" ">
            <div class="layui-table-box">
            <div class="layui-table-header">
            <table cellspacing="0" cellpadding="0" border="0" class="layui-table"><thead>
            <tr>
                <th data-field="0" data-unresize="true">
                    <div class="layui-table-cell laytable-cell-1-0 laytable-cell-checkbox">
                        <input type="checkbox" name="layTableCheckbox" lay-skin="primary" lay-filter="layTableAllChoose">
                        <div class="layui-unselect layui-form-checkbox" lay-skin="primary">
                            <i class="layui-icon layui-icon-ok"></i>
                        </div>
                    </div>
                </th>
                <th data-field="id">
                    <div class="layui-table-cell laytable-cell-1-id">
                        <span>ID</span>
                        <span class="layui-table-sort layui-inline">
                            <i class="layui-edge layui-table-sort-asc"></i>
                            <i class="layui-edge layui-table-sort-desc"></i>
                        </span>
                    </div>
                </th>
                <th data-field="title"><div class="layui-table-cell laytable-cell-1-title"><span>标签名称</span></div></th>
                <th data-field="status" data-minwidth="80">
                    <div class="layui-table-cell laytable-cell-1-status" align="center">
                        <span>状态</span>
                    </div>
                </th>
                <th data-field="7" data-minwidth="150">
                    <div class="layui-table-cell laytable-cell-1-7" align="center"><span>操作</span></div>
                </th>
            </tr>
            </thead>
            </table>
            </div>
            
            <div class="layui-table-body layui-table-main"><table cellspacing="0" cellpadding="0" border="0" class="layui-table"><tbody>
            <foreach name="tags" item="vo">
            <tr data-index="0" class="">
                <td data-field="0">
                    <div class="layui-table-cell laytable-cell-1-0 laytable-cell-checkbox">
                        <input type="checkbox" name="layTableCheckbox" lay-skin="primary">
                        <div class="layui-unselect layui-form-checkbox" lay-skin="primary">
                            <i class="layui-icon layui-icon-ok"></i>
                        </div>
                    </div>
                </td>
                <td data-field="id">
                    <div class="layui-table-cell laytable-cell-1-id">{$vo.id}</div>
                </td>
                <td data-field="title">
                    <div class="layui-table-cell laytable-cell-1-title">
                        {$vo.name}
                    </div>
                </td>
                <td data-field="status" align="center" data-content="true" data-minwidth="80">
                <div class="layui-table-cell laytable-cell-1-status">
                    <button class="layui-btn layui-btn-xs">{$arrStatus[$vo['status']]}</button>
                </div>
            </td>
                <td data-field="7" align="center" data-off="true" data-minwidth="150">
                    <div class="layui-table-cell laytable-cell-1-7">
                            <a data-type="add" class="layui-btn layui-btn-normal layui-btn-xs" lay-event="edit">
                            <i class="layui-icon layui-icon-edit"></i>禁用
                        </a>
                        <a class="layui-btn layui-btn-danger layui-btn-xs" lay-event="del">
                            <i class="layui-icon layui-icon-delete"></i>删除</a>
                    </div>
                </td>
            </tr>
            </foreach>

            </tbody></table></div></div></div> 
            <div class="layui-table-page">
                <div id="layui-table-page1">
                    <div class="layui-box layui-laypage layui-laypage-default" id="layui-laypage-1">

                    {$page|default=''}
            <span class="layui-laypage-skip">到第
                <input id="my-page" type="text" min="1" value="{$currentPage}" class="layui-input">页
                <button type="button" class="layui-laypage-btn" id="pageconfirm">确定
                </button></span><span class="layui-laypage-count">共 {$total} 条</span>
                <span class="layui-laypage-limits">
                    <select lay-filter="pageset"   lay-ignore="" id="my-pageset" data-type="pageset">
                        <option value="2" 
                        <eq name='pageset' value='2'>selected="selected"</eq>
                        >2 条/页</option>
                        <option value="10" <eq name='pageset' value='10'>selected="selected"</eq>>10 条/页</option>
                        <option value="15" <eq name='pageset' value='15'>selected="selected"</eq>>15 条/页</option>
                        <option value="20" <eq name='pageset' value='20'>selected="selected"</eq> >20 条/页</option>
                        <option value="25" <eq name='pageset' value='25'>selected="selected"</eq>>25 条/页</option>
                        <option value="30" <eq name='pageset' value='30'>selected="selected"</eq> >30 条/页</option>
                    </select>
                </span>
                </div>
            </div>
        </div>

            <style>
                .laytable-cell-1-0{ width: 48px; }
                .laytable-cell-1-id{ width: 60px; }
                .laytable-cell-1-label{ width: 283px; }
                .laytable-cell-1-title{ width: 283px; }
                .laytable-cell-1-author{ width: 100px; }
                .laytable-cell-1-uploadtime{ width: 283px; }
                .laytable-cell-1-status{ width:280px; }
                .laytable-cell-1-7{ width: 283px; }
            </style>

            </div>
            <script type="text/html" id="buttonTpl">
                {{#  if(d.status){ }}
                <button class="layui-btn layui-btn-xs">已发布</button>
                {{#  } else { }}
                <button class="layui-btn layui-btn-primary layui-btn-xs">待修改</button>
                {{#  } }}
            </script>
            <script type="text/html" id="table-content-list">
                <a class="layui-btn layui-btn-normal layui-btn-xs" lay-event="edit"><i class="layui-icon layui-icon-edit"></i>编辑</a>
                <a class="layui-btn layui-btn-danger layui-btn-xs" lay-event="del"><i class="layui-icon layui-icon-delete"></i>删除</a>
            </script>
        </div>
    </div>
</div>

<script src="__TMPL__/public/static/admin/layuiadmin/layui/layui.js"></script>
<script>
    layui.config({
        base: '__TMPL__/public/static/admin/layuiadmin/' //静态资源所在路径
    }).extend({
        index: 'lib/index' //主入口模块
    }).use(['index', 'contlist', 'table'], function(){
        var table = layui.table
            ,form = layui.form;

        //监听搜索
        form.on('submit(LAY-app-contlist-search)', function(data){
            var field = data.field;

            //执行重载
            table.reload('LAY-app-content-list', {
                where: field
            });
        });

        var $ = layui.$, active = {
            batchdel: function(){
                var checkStatus = table.checkStatus('LAY-app-content-list')
                    ,checkData = checkStatus.data; //得到选中的数据

                if(checkData.length === 0){
                    return layer.msg('请选择数据');
                }

                layer.confirm('确定删除吗？', function(index) {

                    //执行 Ajax 后重载
                    /*
                    admin.req({
                      url: 'xxx'
                      //,……
                    });
                    */
                    table.reload('LAY-app-content-list');
                    layer.msg('已删除');
                });
            },
            add: function(){
                layer.open({
                    type: 2
                    ,title: '添加文章'
                    ,content: '{:url("AdminTag/add")}'
                    ,maxmin: true
                    ,area: ['80%', '100%']
                    ,yes: function(index, layero){
                        //点击确认触发 iframe 内容中的按钮提交
                        var submit = layero.find('iframe').contents().find("#layuiadmin-app-form-submit");
                        submit.click();
                    }
                });
            }
        };

        $('.layui-btn.layuiadmin-btn-list').on('click', function(){
            var type = $(this).data('type');
            active[type] ? active[type].call(this) : '';
        });

    });
</script>


<script>

    //wjc
    layui.use('layer', function(){
        var $ = layui.jquery, layer = layui.layer;



        $(document).on('click','#pageconfirm',function(){
            page = $("#my-page").val();
            pageset = $("#my-pageset").val();
            // layer.msg("/public/portal/admin_article/index.html?page="+page);
            console.log(page);
            window.location.href="{:url('AdminTag/index',['page'=>1])}?pageset="+pageset;
          
        });


        $(document).on('change','#my-pageset',function(){
            layer.msg("234");
            pageset = $(this).val();
            layer.msg(pageset);
            window.location.href="{:url('AdminTag/index',['page'=>1])}?pageset="+pageset;
          
        });

    });

    $(function () {
        //加载弹出层
        layui.use(['form','element'],
                function() {
                    layer = layui.layer;
                    element = layui.element;
                });



        tableCheck = {
            init:function  () {
                $(".layui-form-checkbox").click(function(event) {
                    if($(this).hasClass('layui-form-checked')){
                        $(this).removeClass('layui-form-checked');
                        if($(this).hasClass('header')){
                            $(".layui-form-checkbox").removeClass('layui-form-checked');
                        }
                    }else{
                        $(this).addClass('layui-form-checked');
                        if($(this).hasClass('header')){
                            $(".layui-form-checkbox").addClass('layui-form-checked');
                        }
                    }

                });
            },
            getData:function  () {
                var obj = $(".layui-form-checked").not('.header');
                var arr=[];
                obj.each(function(index, el) {
                    arr.push(obj.eq(index).attr('data-id'));
                });
                return arr;
            }
        }

        //开启表格多选
        tableCheck.init();


        $('.container .left_open i').click(function(event) {
            if($('.left-nav').css('left')=='0px'){
                $('.left-nav').animate({left: '-221px'}, 100);
                $('.page-content').animate({left: '0px'}, 100);
                $('.page-content-bg').hide();
            }else{
                $('.left-nav').animate({left: '0px'}, 100);
                $('.page-content').animate({left: '221px'}, 100);
                if($(window).width()<768){
                    $('.page-content-bg').show();
                }
            }

        });

        $('.page-content-bg').click(function(event) {
            $('.left-nav').animate({left: '-221px'}, 100);
            $('.page-content').animate({left: '0px'}, 100);
            $(this).hide();
        });

        $('.layui-tab-close').click(function(event) {
            $('.layui-tab-title li').eq(0).find('i').remove();
        });




    })
    var cateIds = [];
    function getCateId(cateId) {

        $("tbody tr[fid="+cateId+"]").each(function(index, el) {
            id = $(el).attr('cate-id');
            cateIds.push(id);
            getCateId(id);
        });
    }

    /*弹出层*/
    /*
     参数解释：
     title   标题
     url     请求的url
     id      需要操作的数据id
     w       弹出层宽度（缺省调默认值）
     h       弹出层高度（缺省调默认值）
     */
    function x_admin_show(title,url,w,h){
        if (title == null || title == '') {
            title=false;
        };
        if (url == null || url == '') {
            url="404.html";
        };
        if (w == null || w == '') {
            w=($(window).width()*0.8);
        };
        if (h == null || h == '') {
            h=($(window).height() - 50);
        };
        layer.open({
            type: 2,
            area: [w+'px', h +'px'],
            fix: false, //不固定
            maxmin: true,
            shadeClose: true,
            shade:0.4,
            title: title,
            content: url
        });
    }

    /*关闭弹出框口*/
    function x_admin_close(){
        var index = parent.layer.getFrameIndex(window.name);
        parent.layer.close(index);
    }
</script>


<style id="LAY_layadmin_theme">
    .layui-side-menu,.layadmin-pagetabs .layui-tab-title li:after,.layadmin-pagetabs .layui-tab-title li.layui-this:after,.layui-layer-admin .layui-layer-title,.layadmin-side-shrink .layui-side-menu .layui-nav>.layui-nav-item>.layui-nav-child{background-color:undefined !important;}.layui-nav-tree .layui-this,.layui-nav-tree .layui-this>a,.layui-nav-tree .layui-nav-child dd.layui-this,.layui-nav-tree .layui-nav-child dd.layui-this a{background-color:undefined !important;}.layui-layout-admin .layui-logo{background-color:#226A62 !important;}.layui-layout-admin .layui-header{background-color:#2F9688;}.layui-layout-admin .layui-header a,.layui-layout-admin .layui-header a cite{color: #f8f8f8;}.layui-layout-admin .layui-header a:hover{color: #fff;}.layui-layout-admin .layui-header .layui-nav .layui-nav-more{border-top-color: #fbfbfb;}.layui-layout-admin .layui-header .layui-nav .layui-nav-mored{border-color: transparent; border-bottom-color: #fbfbfb;}.layui-layout-admin .layui-header .layui-nav .layui-this:after, .layui-layout-admin .layui-header .layui-nav-bar{background-color: #fff; background-color: rgba(255,255,255,.5);}.layadmin-pagetabs .layui-tab-title li:after{display: none;}
</style>
</body>
</html>